"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5703],{69379:function(e,n,t){t.d(n,{C:function(){return a}});var r=t(57437);t(2265);var s=t(61994);function a(e){let{children:n,variant:t="gray",size:a="md",className:i}=e;return(0,r.jsx)("span",{className:(0,s.W)("inline-flex items-center font-medium rounded-full",{success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800",gray:"bg-gray-100 text-gray-800"}[t],{sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs"}[a],i),children:n})}},84226:function(e,n,t){t.d(n,{z:function(){return a}});var r=t(57437);t(2265);var s=t(61994);function a(e){let{variant:n="primary",size:t="md",loading:a=!1,className:i,children:u,disabled:o,...l}=e;return(0,r.jsxs)("button",{className:(0,s.W)("inline-flex items-center justify-center font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200",{primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-primary-500"}[n],{sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[t],(o||a)&&"opacity-50 cursor-not-allowed",i),disabled:o||a,...l,children:[a&&(0,r.jsx)("div",{className:"spinner mr-2"}),u]})}},99178:function(e,n,t){t.d(n,{Ol:function(){return i},Zb:function(){return a},eW:function(){return u}});var r=t(57437);t(2265);var s=t(61994);function a(e){let{children:n,className:t}=e;return(0,r.jsx)("div",{className:(0,s.W)("card",t),children:n})}function i(e){let{children:n,className:t}=e;return(0,r.jsx)("div",{className:(0,s.W)("card-header",t),children:n})}function u(e){let{children:n,className:t}=e;return(0,r.jsx)("div",{className:(0,s.W)("card-body",t),children:n})}},95998:function(e,n,t){t.d(n,{u:function(){return u}});var r=t(57437),s=t(2265),a=t(61994),i=t(32489);function u(e){let{isOpen:n,onClose:t,title:u,children:o,size:l="md",className:c}=e;return((0,s.useEffect)(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t()};return n&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[n,t]),n)?(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,r.jsxs)("div",{className:(0,a.W)("relative bg-white rounded-lg shadow-xl w-full",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[l],c),children:[u&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:u}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)(i.Z,{className:"w-6 h-6"})})]}),(0,r.jsx)("div",{className:"p-6",children:o})]})]})}):null}},46281:function(e,n,t){t.d(n,{AuthProvider:function(){return l},a:function(){return c}});var r=t(57437),s=t(2265),a=t(2141),i=t(69064),u=t(26098);let o=(0,s.createContext)(void 0);function l(e){let{children:n}=e,[t,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[f,h]=(0,s.useState)(null),[g,b]=(0,s.useState)(!0),m=async e=>{try{if(c&&c.id===e){(0,u.wH)("debug","\uD83D\uDD04 User profile already loaded, skipping...");return}(0,u.wH)("debug","\uD83D\uDD04 Loading user profile for:",e);let{data:r,error:s}=await a.supabase.from("users").select("\n          *,\n          company:companies(*)\n        ").eq("id",e).single();if(s){console.warn("⚠️ Could not load user profile:",s.message);let e=(await a.supabase.auth.getUser()).data.user;if(e){var n,t;d({id:e.id,email:e.email,first_name:null===(n=e.user_metadata)||void 0===n?void 0:n.first_name,last_name:null===(t=e.user_metadata)||void 0===t?void 0:t.last_name})}return}(0,u.wH)("debug","✅ User profile loaded successfully"),d(r),h(r.company||null)}catch(e){console.warn("⚠️ Error loading user profile:",e)}};(0,s.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:n}}=await a.supabase.auth.getSession();(null==n?void 0:n.user)&&e&&(l(n.user),await m(n.user.id))}catch(e){console.error("Error initializing auth:",e)}finally{e&&b(!1)}})();let{data:{subscription:n}}=a.supabase.auth.onAuthStateChange(async(e,n)=>{var t;(0,u.wH)("debug","\uD83D\uDD04 Auth state change:",e,null==n?void 0:null===(t=n.user)||void 0===t?void 0:t.id),"SIGNED_OUT"===e?(l(null),d(null),h(null),i.ZP.success("Sesi\xf3n cerrada")):"SIGNED_IN"===e&&(null==n?void 0:n.user)?(l(n.user),c&&c.id===n.user.id||await m(n.user.id)):"TOKEN_REFRESHED"===e&&(0,u.wH)("debug","\uD83D\uDD04 Token refreshed successfully")}),r=setInterval(async()=>{if(e&&t)try{let{data:{session:e},error:n}=await a.supabase.auth.getSession();(n||!e)&&((0,u.wH)("info","\uD83D\uDD04 Session expired, signing out..."),l(null),d(null),h(null),i.ZP.error("Sesi\xf3n expirada. Por favor, inicia sesi\xf3n nuevamente."))}catch(e){console.warn("⚠️ Error checking session:",e)}},u.ob.SESSION.CHECK_INTERVAL);return()=>{e=!1,n.unsubscribe(),clearInterval(r)}},[]);let p=async(e,n)=>{let{data:t,error:r}=await a.supabase.auth.signInWithPassword({email:e,password:n});if(r)throw r;return t},y=async(e,n,t)=>{let{data:r,error:s}=await a.supabase.auth.signUp({email:e,password:n,options:{data:t}});if(s)throw s;return r},I=async()=>{await a.supabase.auth.signOut()},w=async e=>{if(!t)throw Error("Usuario no autenticado");let{error:n}=await a.supabase.from("users").update(e).eq("id",t.id);if(n)throw n;await m(t.id)};return(0,r.jsx)(o.Provider,{value:{user:t,profile:c,company:f,loading:g,signIn:p,signUp:y,signOut:I,updateProfile:w},children:n})}function c(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},26098:function(e,n,t){t.d(n,{ob:function(){return r},wH:function(){return s}});let r={CACHE:{STALE_TIME:3e4,REFETCH_INTERVAL:3e5,REQUEST_TIMEOUT:1e4},SESSION:{CHECK_INTERVAL:6e4,WARNING_TIME:3e5},LOGGING:{ENABLED:!1,MIN_LEVEL:"error"},SUPABASE:{CONNECTION_POOL_SIZE:10,CONNECTION_TIMEOUT:5e3,AUTO_RETRY:!0,MAX_RETRIES:3,SINGLETON_MODE:!0,CHECK_INITIALIZATION:!0}},s=function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),s=1;s<n;s++)t[s-1]=arguments[s];if(!r.LOGGING.ENABLED)return;let a=["debug","info","warn","error"];a.indexOf(e)>=a.indexOf(r.LOGGING.MIN_LEVEL)&&console[e](...t)}},2141:function(e,n,t){t.r(n),t.d(n,{supabase:function(){return i},supabaseAdmin:function(){return u}});var r=t(63887);let s="https://pbdsuhmwxqiwbpgyrhqt.supabase.co";function a(e,n,t){return(0,r.eI)(e,n,{...t,auth:{...t.auth,storage:window.localStorage,storageKey:"supabase.auth.token",flowType:"pkce",debug:!1,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}let{supabase:i,supabaseAdmin:u}=function(){if(!globalThis.__supabaseInitialized){if(globalThis.__supabase)try{var e,n;null===(e=(n=globalThis.__supabase).removeAllChannels)||void 0===e||e.call(n)}catch(e){}globalThis.__supabase=a(s,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiZHN1aG13eHFpd2JwZ3lyaHF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwODYyMzMsImV4cCI6MjA3NDY2MjIzM30.u5TqGGpULVAD062GT3zbfdC5RwOrj-jacJhWNSbfqus",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),globalThis.__supabaseAdmin=a(s,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiZHN1aG13eHFpd2JwZ3lyaHF0Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1OTA4NjIzMywiZXhwIjoyMDc0NjYyMjMzfQ.vZDNEvaGYn4-FAvyym69OQxFZkpc4m1ufcCn45Jn3jE",{auth:{persistSession:!1,autoRefreshToken:!1}}),globalThis.__supabaseInitialized=!0}return{supabase:globalThis.__supabase,supabaseAdmin:globalThis.__supabaseAdmin}}()},83774:function(e,n,t){t.d(n,{Z:function(){return r}});let r=(0,t(39763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])}}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9597],{12328:function(e,s,t){Promise.resolve().then(t.bind(t,2531))},2531:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return f}});var r=t(57437),a=t(2265),n=t(99178),i=t(62953),l=t(99397),c=t(40340),o=t(42208),d=t(94630),u=t(18930),m=t(46281),x=t(2141),h=t(69064);function f(){let{company:e}=(0,m.a)(),[s,t]=(0,a.useState)([]),[f,p]=(0,a.useState)(!0),[g,y]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),[b,N]=(0,a.useState)(!1),[w,I]=(0,a.useState)(null),[E,_]=(0,a.useState)(null),[C,k]=(0,a.useState)({name:"",contact_person:"",email:"",phone:"",address:"",website:"",payment_terms:"30",is_active:!0}),S=()=>{k({name:"",contact_person:"",email:"",phone:"",address:"",website:"",payment_terms:"30",is_active:!0})};(0,a.useEffect)(()=>{Z()},[]);let Z=async()=>{try{if(p(!0),!e){console.error("No company found");return}let{data:s,error:r}=await x.supabase.from("suppliers").select("*").eq("company_id",e.id).order("name",{ascending:!0});if(r)throw r;t(s||[])}catch(e){console.error("Error loading suppliers:",e),h.ZP.error("Error cargando proveedores")}finally{p(!1)}},T=e=>{let{name:s,value:t,type:r}=e.target;k(a=>({...a,[s]:"checkbox"===r?e.target.checked:t}))},z=async e=>{e.preventDefault();try{if(await new Promise(e=>setTimeout(e,1e3)),w){let e=s.map(e=>e.id===w.id?{...e,...C}:e);t(e),h.ZP.success("Proveedor actualizado correctamente")}else{let e={id:Date.now(),...C,materials_count:0,last_order:new Date().toISOString().split("T")[0]};t([...s,e]),h.ZP.success("Proveedor creado correctamente")}y(!1),I(null),S()}catch(e){h.ZP.error("Error guardando proveedor")}},A=()=>{I(null),S(),y(!0)},P=e=>{I(e),k({name:e.name,contact_person:e.contact_person,email:e.email,phone:e.phone,address:e.address,website:e.website,payment_terms:e.payment_terms,is_active:e.is_active}),y(!0)},M=e=>{_(e),j(!0)},O=e=>{_(e),N(!0)},D=async()=>{if(E)try{let e=s.filter(e=>e.id!==E.id);t(e),N(!1),_(null),h.ZP.success("Proveedor eliminado correctamente")}catch(e){h.ZP.error("Error eliminando proveedor")}};return f?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Proveedores"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Gestiona tus proveedores y relaciones comerciales"})]}),(0,r.jsxs)(i.zx,{onClick:A,className:"flex items-center space-x-2",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Nuevo Proveedor"})]})]}),0===s.length?(0,r.jsx)(n.Zb,{children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(c.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hay proveedores"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Comienza agregando tu primer proveedor."}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)(i.zx,{onClick:A,children:[(0,r.jsx)(l.Z,{className:"h-4 w-4 mr-2"}),"Nuevo Proveedor"]})})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,r.jsx)(n.Zb,{children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,r.jsx)(c.Z,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:e.contact_person})]})]}),(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.is_active?"Activo":"Inactivo"})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Email:"})," ",e.email]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Tel\xe9fono:"})," ",e.phone]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Materiales:"})," ",e.materials_count]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"\xdaltimo pedido:"})," ",e.last_order]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)(i.zx,{variant:"outline",size:"sm",onClick:()=>M(e),className:"flex-1",children:[(0,r.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),"Ver"]}),(0,r.jsxs)(i.zx,{variant:"outline",size:"sm",onClick:()=>P(e),className:"flex-1",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Editar"]}),(0,r.jsx)(i.zx,{variant:"outline",size:"sm",onClick:()=>O(e),className:"text-red-600 hover:text-red-700",children:(0,r.jsx)(u.Z,{className:"h-4 w-4"})})]})]})},e.id))}),(0,r.jsx)(i.u_,{isOpen:g,onClose:()=>y(!1),title:w?"Editar Proveedor":"Nuevo Proveedor",size:"lg",children:(0,r.jsxs)("form",{onSubmit:z,className:"space-y-4",children:[(0,r.jsx)(i.II,{label:"Nombre del proveedor",name:"name",value:C.name,onChange:T,required:!0}),(0,r.jsx)(i.II,{label:"Persona de contacto",name:"contact_person",value:C.contact_person,onChange:T,required:!0}),(0,r.jsx)(i.II,{label:"Email",name:"email",type:"email",value:C.email,onChange:T,required:!0}),(0,r.jsx)(i.II,{label:"Tel\xe9fono",name:"phone",value:C.phone,onChange:T}),(0,r.jsx)(i.II,{label:"Direcci\xf3n",name:"address",value:C.address,onChange:T}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(i.II,{label:"Sitio web",name:"website",value:C.website,onChange:T,placeholder:"www.ejemplo.com"}),(0,r.jsx)(i.II,{label:"T\xe9rminos de pago (d\xedas)",name:"payment_terms",type:"number",value:C.payment_terms,onChange:T})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"is_active",name:"is_active",checked:C.is_active,onChange:T,className:"rounded"}),(0,r.jsx)("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:"Proveedor activo"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)(i.zx,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancelar"}),(0,r.jsxs)(i.zx,{type:"submit",children:[w?"Actualizar":"Crear"," Proveedor"]})]})]})}),(0,r.jsx)(i.u_,{isOpen:v,onClose:()=>j(!1),title:"Detalles del Proveedor",size:"lg",children:E&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Proveedor"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:E.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Contacto"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:E.contact_person})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:E.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Tel\xe9fono"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:E.phone})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Direcci\xf3n"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:E.address})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Sitio web"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:E.website||"No especificado"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Materiales"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:E.materials_count})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:E.is_active?"Activo":"Inactivo"})]})]}),(0,r.jsx)("div",{className:"pt-4 border-t",children:(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsxs)(i.zx,{onClick:()=>P(E),className:"flex-1",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Editar"]}),(0,r.jsxs)(i.zx,{onClick:()=>O(E),variant:"outline",className:"flex-1 text-red-600 hover:text-red-700",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})})]})}),(0,r.jsx)(i.u_,{isOpen:b,onClose:()=>N(!1),title:"Confirmar Eliminaci\xf3n",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("p",{className:"text-gray-600",children:["\xbfEst\xe1s seguro de que quieres eliminar el proveedor"," ",(0,r.jsx)("strong",{children:null==E?void 0:E.name}),"?"]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Esta acci\xf3n no se puede deshacer."}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)(i.zx,{variant:"outline",onClick:()=>N(!1),children:"Cancelar"}),(0,r.jsxs)(i.zx,{variant:"danger",onClick:D,children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]})})]})}},69379:function(e,s,t){"use strict";t.d(s,{C:function(){return n}});var r=t(57437);t(2265);var a=t(61994);function n(e){let{children:s,variant:t="gray",size:n="md",className:i}=e;return(0,r.jsx)("span",{className:(0,a.W)("inline-flex items-center font-medium rounded-full",{success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800",gray:"bg-gray-100 text-gray-800"}[t],{sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs"}[n],i),children:s})}},84226:function(e,s,t){"use strict";t.d(s,{z:function(){return n}});var r=t(57437);t(2265);var a=t(61994);function n(e){let{variant:s="primary",size:t="md",loading:n=!1,className:i,children:l,disabled:c,...o}=e;return(0,r.jsxs)("button",{className:(0,a.W)("inline-flex items-center justify-center font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200",{primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-primary-500"}[s],{sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[t],(c||n)&&"opacity-50 cursor-not-allowed",i),disabled:c||n,...o,children:[n&&(0,r.jsx)("div",{className:"spinner mr-2"}),l]})}},99178:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},Zb:function(){return n},eW:function(){return l}});var r=t(57437);t(2265);var a=t(61994);function n(e){let{children:s,className:t}=e;return(0,r.jsx)("div",{className:(0,a.W)("card",t),children:s})}function i(e){let{children:s,className:t}=e;return(0,r.jsx)("div",{className:(0,a.W)("card-header",t),children:s})}function l(e){let{children:s,className:t}=e;return(0,r.jsx)("div",{className:(0,a.W)("card-body",t),children:s})}},96372:function(e,s,t){"use strict";t.d(s,{v:function(){return m}});var r=t(57437),a=t(2265),n=t(22574),i=t(84226),l=t(32489),c=t(41414),o=t(45802),d=t(43391),u=t(30401);function m(e){let{isOpen:s,onClose:t,onSave:m,imageFile:x,aspectRatio:h=1,title:f="Editar Imagen",circular:p=!1}=e,[g,y]=(0,a.useState)(),[v,j]=(0,a.useState)(),[b,N]=(0,a.useState)(1),[w,I]=(0,a.useState)(0),[E,_]=(0,a.useState)(""),C=(0,a.useRef)(null),k=(0,a.useRef)(null);a.useEffect(()=>{if(s&&x){let e=new FileReader;e.onload=e=>{var s;_(null===(s=e.target)||void 0===s?void 0:s.result)},e.readAsDataURL(x)}},[s,x]);let S=(0,a.useCallback)(e=>{let{width:s,height:t}=e.currentTarget;y((0,n._H)((0,n.YG)({unit:"%",width:90},h,s,t),s,t))},[h]),Z=(e,s)=>{let t=k.current;if(!t)throw Error("Canvas no disponible");let r=t.getContext("2d");if(!r)throw Error("Contexto 2D no disponible");let a=e.naturalWidth/e.width,n=e.naturalHeight/e.height,i=window.devicePixelRatio;return t.width=s.width*i*a,t.height=s.height*i*n,r.setTransform(i,0,0,i,0,0),r.imageSmoothingQuality="high",0!==w&&(r.translate(t.width/2,t.height/2),r.rotate(w*Math.PI/180),r.translate(-t.width/2,-t.height/2)),r.drawImage(e,s.x*a,s.y*n,s.width*a,s.height*n,0,0,t.width/i,t.height/i),new Promise(e=>{t.toBlob(s=>{s&&e(s)},"image/jpeg",.95)})},T=async()=>{if(C.current&&v)try{let e=await Z(C.current,v);m(e),t()}catch(e){console.error("Error al procesar la imagen:",e)}};return s&&E?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:f}),(0,r.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,r.jsx)(l.Z,{className:"h-5 w-5 text-gray-500"})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-4 p-4 border-b border-gray-200 bg-gray-50",children:[(0,r.jsxs)(i.z,{variant:"secondary",size:"sm",onClick:()=>{I(e=>(e+90)%360)},className:"flex items-center",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Rotar"]}),(0,r.jsxs)(i.z,{variant:"secondary",size:"sm",onClick:()=>{N(e=>Math.max(e-.1,.5))},className:"flex items-center",children:[(0,r.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Alejar"]}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[Math.round(100*b),"%"]}),(0,r.jsxs)(i.z,{variant:"secondary",size:"sm",onClick:()=>{N(e=>Math.min(e+.1,3))},className:"flex items-center",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Acercar"]})]}),(0,r.jsx)("div",{className:"p-4 overflow-auto max-h-[60vh]",children:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(n.ZP,{crop:g,onChange:(e,s)=>y(s),onComplete:e=>j(e),aspect:h,circularCrop:p,children:(0,r.jsx)("img",{ref:C,alt:"Crop me",src:E,style:{transform:"scale(".concat(b,") rotate(").concat(w,"deg)"),maxWidth:"100%",maxHeight:"400px"},onLoad:S})})})}),(0,r.jsx)("canvas",{ref:k,style:{display:"none"}}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 p-4 border-t border-gray-200",children:[(0,r.jsx)(i.z,{variant:"secondary",onClick:t,children:"Cancelar"}),(0,r.jsxs)(i.z,{onClick:T,disabled:!v,className:"btn-primary flex items-center",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Guardar"]})]})]})}):null}t(83814)},38068:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var r=t(57437);t(2265);var a=t(61994);function n(e){let{label:s,error:t,helperText:n,className:i,id:l,...c}=e,o=l||"input-".concat(Math.random().toString(36).substr(2,9));return(0,r.jsxs)("div",{className:"w-full",children:[s&&(0,r.jsxs)("label",{htmlFor:o,className:"form-label",children:[s,c.required&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,r.jsx)("input",{id:o,className:(0,a.W)("form-input",t&&"border-red-300 focus:ring-red-500 focus:border-red-500",i),...c}),t&&(0,r.jsx)("p",{className:"form-error",children:t}),n&&!t&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:n})]})}},95998:function(e,s,t){"use strict";t.d(s,{u:function(){return l}});var r=t(57437),a=t(2265),n=t(61994),i=t(32489);function l(e){let{isOpen:s,onClose:t,title:l,children:c,size:o="md",className:d}=e;return((0,a.useEffect)(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t()};return s&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[s,t]),s)?(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,r.jsxs)("div",{className:(0,n.W)("relative bg-white rounded-lg shadow-xl w-full",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[o],d),children:[l&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:l}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)(i.Z,{className:"w-6 h-6"})})]}),(0,r.jsx)("div",{className:"p-6",children:c})]})]})}):null}},95930:function(e,s,t){"use strict";t.d(s,{iA:function(){return n}});var r=t(57437);t(2265);var a=t(61994);function n(e){let{children:s,className:t}=e;return(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)("table",{className:(0,a.W)("table",t),children:s})})}},62953:function(e,s,t){"use strict";t.d(s,{Ct:function(){return n.C},II:function(){return i.I},Zb:function(){return r.Zb},u_:function(){return l.u},zx:function(){return a.z}});var r=t(99178),a=t(84226),n=t(69379),i=t(38068),l=t(95998);t(95930),t(96372)},46281:function(e,s,t){"use strict";t.d(s,{AuthProvider:function(){return o},a:function(){return d}});var r=t(57437),a=t(2265),n=t(2141),i=t(69064),l=t(26098);let c=(0,a.createContext)(void 0);function o(e){let{children:s}=e,[t,o]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),[h,f]=(0,a.useState)(!0),p=async e=>{try{if(d&&d.id===e){(0,l.wH)("debug","\uD83D\uDD04 User profile already loaded, skipping...");return}(0,l.wH)("debug","\uD83D\uDD04 Loading user profile for:",e);let{data:r,error:a}=await (0,n.supabaseTable)("users").select("\n          *,\n          company:companies(*)\n        ").eq("id",e).single();if(a){console.warn("⚠️ Could not load user profile:",a.message);let e=(await n.supabase.auth.getUser()).data.user;if(e){var s,t;u({id:e.id,email:e.email,first_name:null===(s=e.user_metadata)||void 0===s?void 0:s.first_name,last_name:null===(t=e.user_metadata)||void 0===t?void 0:t.last_name})}return}(0,l.wH)("debug","✅ User profile loaded successfully"),u(r),x(r.company||null)}catch(e){console.warn("⚠️ Error loading user profile:",e)}};(0,a.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:s}}=await n.supabase.auth.getSession();(null==s?void 0:s.user)&&e&&(o(s.user),await p(s.user.id))}catch(e){console.error("Error initializing auth:",e)}finally{e&&f(!1)}})();let{data:{subscription:s}}=n.supabase.auth.onAuthStateChange(async(e,s)=>{var t;(0,l.wH)("debug","\uD83D\uDD04 Auth state change:",e,null==s?void 0:null===(t=s.user)||void 0===t?void 0:t.id),"SIGNED_OUT"===e?(o(null),u(null),x(null),i.ZP.success("Sesi\xf3n cerrada")):"SIGNED_IN"===e&&(null==s?void 0:s.user)?(o(s.user),d&&d.id===s.user.id||await p(s.user.id)):"TOKEN_REFRESHED"===e&&(0,l.wH)("debug","\uD83D\uDD04 Token refreshed successfully")});return()=>{e=!1,s.unsubscribe()}},[]);let g=async(e,s)=>{let{data:t,error:r}=await n.supabase.auth.signInWithPassword({email:e,password:s});if(r)throw r;return t},y=async(e,s,t)=>{let{data:r,error:a}=await n.supabase.auth.signUp({email:e,password:s,options:{data:t}});if(a)throw a;return r},v=async()=>{await n.supabase.auth.signOut()},j=async e=>{if(!t)throw Error("Usuario no autenticado");let{error:s}=await (0,n.supabaseTable)("users").update(e).eq("id",t.id);if(s)throw s;await p(t.id)};return(0,r.jsx)(c.Provider,{value:{user:t,profile:d,company:m,loading:h,signIn:g,signUp:y,signOut:v,updateProfile:j},children:s})}function d(){let e=(0,a.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},26098:function(e,s,t){"use strict";t.d(s,{ob:function(){return r},wH:function(){return a}});let r={CACHE:{STALE_TIME:3e4,REFETCH_INTERVAL:3e5,REQUEST_TIMEOUT:1e4},SESSION:{CHECK_INTERVAL:6e4,WARNING_TIME:3e5},LOGGING:{ENABLED:!1,MIN_LEVEL:"error"},SUPABASE:{CONNECTION_POOL_SIZE:10,CONNECTION_TIMEOUT:5e3,AUTO_RETRY:!0,MAX_RETRIES:3,SINGLETON_MODE:!0,CHECK_INITIALIZATION:!0}},a=function(e){for(var s=arguments.length,t=Array(s>1?s-1:0),a=1;a<s;a++)t[a-1]=arguments[a];if(!r.LOGGING.ENABLED)return;let n=["debug","info","warn","error"];n.indexOf(e)>=n.indexOf(r.LOGGING.MIN_LEVEL)&&console[e](...t)}},2141:function(e,s,t){"use strict";t.r(s),t.d(s,{supabase:function(){return m},supabaseAdmin:function(){return x},supabaseAdminTable:function(){return f},supabaseTable:function(){return h}});var r,a,n,i,l=t(63887),c=t(40257);let o=c.env.NEXT_PUBLIC_SUPABASE_URL||"https://pbdsuhmwxqiwbpgyrhqt.supabase.co",d=c.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiZHN1aG13eHFpd2JwZ3lyaHF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwODYyMzMsImV4cCI6MjA3NDY2MjIzM30.u5TqGGpULVAD062GT3zbfdC5RwOrj-jacJhWNSbfqus",u=c.env.NEXT_PUBLIC_SUPABASE_SERVICE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiZHN1aG13eHFpd2JwZ3lyaHF0Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1OTA4NjIzMywiZXhwIjoyMDc0NjYyMjMzfQ.vZDNEvaGYn4-FAvyym69OQxFZkpc4m1ufcCn45Jn3jE",m=null!==(n=(r=globalThis).__supabaseClient)&&void 0!==n?n:r.__supabaseClient=(0,l.eI)(o,d,{auth:{flowType:"pkce",persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"supabase.auth.token"}}),x=null!==(i=(a=globalThis).__supabaseAdminClient)&&void 0!==i?i:a.__supabaseAdminClient=(0,l.eI)(o,u,{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1,storageKey:"supabase.admin.token"}}),h=e=>m.from(e),f=e=>x.from(e)},42208:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(39763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},94630:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(39763).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},99397:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(39763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},18930:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(39763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},40340:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(39763).Z)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]])}},function(e){e.O(0,[5558,8829,3926,2971,2117,1744],function(){return e(e.s=12328)}),_N_E=e.O()}]);
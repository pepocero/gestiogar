(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5133],{17464:function(e,s,t){Promise.resolve().then(t.bind(t,37565))},37565:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return f}});var a=t(57437),r=t(2265),n=t(99178),i=t(62953),l=t(99397),c=t(44794),o=t(42208),d=t(94630),u=t(18930),m=t(46281),x=t(2141),h=t(69064);function f(){let{company:e}=(0,m.a)(),[s,t]=(0,r.useState)([]),[f,g]=(0,r.useState)(!0),[p,y]=(0,r.useState)(!1),[j,b]=(0,r.useState)(!1),[v,N]=(0,r.useState)(!1),[w,k]=(0,r.useState)(null),[I,_]=(0,r.useState)(null),[C,E]=(0,r.useState)({name:"",description:"",category:"",unit_price:"",stock_quantity:"",min_stock:"",supplier:"",sku:""}),S=()=>{E({name:"",description:"",category:"",unit_price:"",stock_quantity:"",min_stock:"",supplier:"",sku:""})};(0,r.useEffect)(()=>{Z()},[]);let Z=async()=>{try{if(g(!0),!e){console.error("No company found");return}let{data:s,error:a}=await x.supabase.from("materials").select("\n          *,\n          suppliers(name)\n        ").eq("company_id",e.id).order("name",{ascending:!0});if(a)throw a;t(s||[])}catch(e){console.error("Error loading materials:",e),h.ZP.error("Error cargando materiales")}finally{g(!1)}},z=e=>{let{name:s,value:t}=e.target;E(e=>({...e,[s]:t}))},M=async e=>{e.preventDefault();try{await new Promise(e=>setTimeout(e,1e3));let e={...C,unit_price:parseFloat(C.unit_price)||0,stock_quantity:parseInt(C.stock_quantity)||0,min_stock:parseInt(C.min_stock)||0};if(w){let a=s.map(s=>s.id===w.id?{...s,...e}:s);t(a),h.ZP.success("Material actualizado correctamente")}else{let a={id:Date.now(),...e,low_stock:e.stock_quantity<e.min_stock};t([...s,a]),h.ZP.success("Material creado correctamente")}y(!1),k(null),S()}catch(e){h.ZP.error("Error guardando material")}},T=()=>{k(null),S(),y(!0)},D=e=>{k(e),E({name:e.name,description:e.description,category:e.category,unit_price:e.unit_price.toString(),stock_quantity:e.stock_quantity.toString(),min_stock:e.min_stock.toString(),supplier:e.supplier,sku:e.sku}),y(!0)},A=e=>{_(e),b(!0)},O=e=>{_(e),N(!0)},P=async()=>{if(I)try{let e=s.filter(e=>e.id!==I.id);t(e),N(!1),_(null),h.ZP.success("Material eliminado correctamente")}catch(e){h.ZP.error("Error eliminando material")}};return f?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Materiales"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Gestiona el inventario de materiales"})]}),(0,a.jsxs)(i.zx,{onClick:T,className:"flex items-center space-x-2",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Nuevo Material"})]})]}),0===s.length?(0,a.jsx)(n.Zb,{children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(c.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hay materiales"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Comienza agregando tu primer material."}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)(i.zx,{onClick:T,children:[(0,a.jsx)(l.Z,{className:"h-4 w-4 mr-2"}),"Nuevo Material"]})})]})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,a.jsx)(n.Zb,{children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat(e.low_stock?"bg-red-100":"bg-green-100"),children:(0,a.jsx)(c.Z,{className:"h-6 w-6 ".concat(e.low_stock?"text-red-600":"text-green-600")})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.category})]})]}),e.low_stock&&(0,a.jsx)(i.Ct,{variant:"warning",children:"Stock Bajo"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"SKU:"})," ",e.sku]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Stock:"})," ",e.stock_quantity," und"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Precio:"})," €",e.unit_price]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Proveedor:"})," ",e.supplier]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(i.zx,{variant:"outline",size:"sm",onClick:()=>A(e),className:"flex-1",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),"Ver"]}),(0,a.jsxs)(i.zx,{variant:"outline",size:"sm",onClick:()=>D(e),className:"flex-1",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Editar"]}),(0,a.jsx)(i.zx,{variant:"outline",size:"sm",onClick:()=>O(e),className:"text-red-600 hover:text-red-700",children:(0,a.jsx)(u.Z,{className:"h-4 w-4"})})]})]})},e.id))}),(0,a.jsx)(i.u_,{isOpen:p,onClose:()=>y(!1),title:w?"Editar Material":"Nuevo Material",size:"lg",children:(0,a.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,a.jsx)(i.II,{label:"Nombre del material",name:"name",value:C.name,onChange:z,required:!0}),(0,a.jsx)(i.II,{label:"Descripci\xf3n",name:"description",value:C.description,onChange:z}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(i.II,{label:"Categor\xeda",name:"category",value:C.category,onChange:z}),(0,a.jsx)(i.II,{label:"SKU",name:"sku",value:C.sku,onChange:z})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(i.II,{label:"Precio unitario (€)",name:"unit_price",type:"number",step:"0.01",value:C.unit_price,onChange:z}),(0,a.jsx)(i.II,{label:"Stock actual",name:"stock_quantity",type:"number",value:C.stock_quantity,onChange:z})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(i.II,{label:"Stock m\xednimo",name:"min_stock",type:"number",value:C.min_stock,onChange:z}),(0,a.jsx)(i.II,{label:"Proveedor",name:"supplier",value:C.supplier,onChange:z})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)(i.zx,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancelar"}),(0,a.jsxs)(i.zx,{type:"submit",children:[w?"Actualizar":"Crear"," Material"]})]})]})}),(0,a.jsx)(i.u_,{isOpen:j,onClose:()=>b(!1),title:"Detalles del Material",size:"lg",children:I&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Material"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:I.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Categor\xeda"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:I.category})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"SKU"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:I.sku})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Precio"}),(0,a.jsxs)("p",{className:"text-sm text-gray-900",children:["€",I.unit_price]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Actual"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:I.stock_quantity})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Stock M\xednimo"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:I.min_stock})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Proveedor"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:I.supplier})]})]}),I.description&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:I.description})]}),(0,a.jsx)("div",{className:"pt-4 border-t",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)(i.zx,{onClick:()=>D(I),className:"flex-1",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Editar"]}),(0,a.jsxs)(i.zx,{onClick:()=>O(I),variant:"outline",className:"flex-1 text-red-600 hover:text-red-700",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})})]})}),(0,a.jsx)(i.u_,{isOpen:v,onClose:()=>N(!1),title:"Confirmar Eliminaci\xf3n",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("p",{className:"text-gray-600",children:["\xbfEst\xe1s seguro de que quieres eliminar el material"," ",(0,a.jsx)("strong",{children:null==I?void 0:I.name}),"?"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Esta acci\xf3n no se puede deshacer."}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)(i.zx,{variant:"outline",onClick:()=>N(!1),children:"Cancelar"}),(0,a.jsxs)(i.zx,{variant:"danger",onClick:P,children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]})})]})}},69379:function(e,s,t){"use strict";t.d(s,{C:function(){return n}});var a=t(57437);t(2265);var r=t(61994);function n(e){let{children:s,variant:t="gray",size:n="md",className:i}=e;return(0,a.jsx)("span",{className:(0,r.W)("inline-flex items-center font-medium rounded-full",{success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800",gray:"bg-gray-100 text-gray-800"}[t],{sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs"}[n],i),children:s})}},84226:function(e,s,t){"use strict";t.d(s,{z:function(){return n}});var a=t(57437);t(2265);var r=t(61994);function n(e){let{variant:s="primary",size:t="md",loading:n=!1,className:i,children:l,disabled:c,...o}=e;return(0,a.jsxs)("button",{className:(0,r.W)("inline-flex items-center justify-center font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200",{primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-primary-500"}[s],{sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[t],(c||n)&&"opacity-50 cursor-not-allowed",i),disabled:c||n,...o,children:[n&&(0,a.jsx)("div",{className:"spinner mr-2"}),l]})}},99178:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},Zb:function(){return n},eW:function(){return l}});var a=t(57437);t(2265);var r=t(61994);function n(e){let{children:s,className:t}=e;return(0,a.jsx)("div",{className:(0,r.W)("card",t),children:s})}function i(e){let{children:s,className:t}=e;return(0,a.jsx)("div",{className:(0,r.W)("card-header",t),children:s})}function l(e){let{children:s,className:t}=e;return(0,a.jsx)("div",{className:(0,r.W)("card-body",t),children:s})}},96372:function(e,s,t){"use strict";t.d(s,{v:function(){return m}});var a=t(57437),r=t(2265),n=t(22574),i=t(84226),l=t(32489),c=t(41414),o=t(45802),d=t(43391),u=t(30401);function m(e){let{isOpen:s,onClose:t,onSave:m,imageFile:x,aspectRatio:h=1,title:f="Editar Imagen",circular:g=!1}=e,[p,y]=(0,r.useState)(),[j,b]=(0,r.useState)(),[v,N]=(0,r.useState)(1),[w,k]=(0,r.useState)(0),[I,_]=(0,r.useState)(""),C=(0,r.useRef)(null),E=(0,r.useRef)(null);r.useEffect(()=>{if(s&&x){let e=new FileReader;e.onload=e=>{var s;_(null===(s=e.target)||void 0===s?void 0:s.result)},e.readAsDataURL(x)}},[s,x]);let S=(0,r.useCallback)(e=>{let{width:s,height:t}=e.currentTarget;y((0,n._H)((0,n.YG)({unit:"%",width:90},h,s,t),s,t))},[h]),Z=(e,s)=>{let t=E.current;if(!t)throw Error("Canvas no disponible");let a=t.getContext("2d");if(!a)throw Error("Contexto 2D no disponible");let r=e.naturalWidth/e.width,n=e.naturalHeight/e.height,i=window.devicePixelRatio;return t.width=s.width*i*r,t.height=s.height*i*n,a.setTransform(i,0,0,i,0,0),a.imageSmoothingQuality="high",0!==w&&(a.translate(t.width/2,t.height/2),a.rotate(w*Math.PI/180),a.translate(-t.width/2,-t.height/2)),a.drawImage(e,s.x*r,s.y*n,s.width*r,s.height*n,0,0,t.width/i,t.height/i),new Promise(e=>{t.toBlob(s=>{s&&e(s)},"image/jpeg",.95)})},z=async()=>{if(C.current&&j)try{let e=await Z(C.current,j);m(e),t()}catch(e){console.error("Error al procesar la imagen:",e)}};return s&&I?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:f}),(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(l.Z,{className:"h-5 w-5 text-gray-500"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-4 p-4 border-b border-gray-200 bg-gray-50",children:[(0,a.jsxs)(i.z,{variant:"secondary",size:"sm",onClick:()=>{k(e=>(e+90)%360)},className:"flex items-center",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Rotar"]}),(0,a.jsxs)(i.z,{variant:"secondary",size:"sm",onClick:()=>{N(e=>Math.max(e-.1,.5))},className:"flex items-center",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Alejar"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[Math.round(100*v),"%"]}),(0,a.jsxs)(i.z,{variant:"secondary",size:"sm",onClick:()=>{N(e=>Math.min(e+.1,3))},className:"flex items-center",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Acercar"]})]}),(0,a.jsx)("div",{className:"p-4 overflow-auto max-h-[60vh]",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(n.ZP,{crop:p,onChange:(e,s)=>y(s),onComplete:e=>b(e),aspect:h,circularCrop:g,children:(0,a.jsx)("img",{ref:C,alt:"Crop me",src:I,style:{transform:"scale(".concat(v,") rotate(").concat(w,"deg)"),maxWidth:"100%",maxHeight:"400px"},onLoad:S})})})}),(0,a.jsx)("canvas",{ref:E,style:{display:"none"}}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 p-4 border-t border-gray-200",children:[(0,a.jsx)(i.z,{variant:"secondary",onClick:t,children:"Cancelar"}),(0,a.jsxs)(i.z,{onClick:z,disabled:!j,className:"btn-primary flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Guardar"]})]})]})}):null}t(83814)},38068:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var a=t(57437);t(2265);var r=t(61994);function n(e){let{label:s,error:t,helperText:n,className:i,id:l,...c}=e,o=l||"input-".concat(Math.random().toString(36).substr(2,9));return(0,a.jsxs)("div",{className:"w-full",children:[s&&(0,a.jsx)("label",{htmlFor:o,className:"form-label",children:s}),(0,a.jsx)("input",{id:o,className:(0,r.W)("form-input",t&&"border-red-300 focus:ring-red-500 focus:border-red-500",i),...c}),t&&(0,a.jsx)("p",{className:"form-error",children:t}),n&&!t&&(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:n})]})}},95998:function(e,s,t){"use strict";t.d(s,{u:function(){return l}});var a=t(57437),r=t(2265),n=t(61994),i=t(32489);function l(e){let{isOpen:s,onClose:t,title:l,children:c,size:o="md",className:d}=e;return((0,r.useEffect)(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t()};return s&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[s,t]),s)?(0,a.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,a.jsxs)("div",{className:(0,n.W)("relative bg-white rounded-lg shadow-xl w-full",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[o],d),children:[l&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:l}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(i.Z,{className:"w-6 h-6"})})]}),(0,a.jsx)("div",{className:"p-6",children:c})]})]})}):null}},95930:function(e,s,t){"use strict";t.d(s,{iA:function(){return n}});var a=t(57437);t(2265);var r=t(61994);function n(e){let{children:s,className:t}=e;return(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("table",{className:(0,r.W)("table",t),children:s})})}},62953:function(e,s,t){"use strict";t.d(s,{Ct:function(){return n.C},II:function(){return i.I},Zb:function(){return a.Zb},u_:function(){return l.u},zx:function(){return r.z}});var a=t(99178),r=t(84226),n=t(69379),i=t(38068),l=t(95998);t(95930),t(96372)},46281:function(e,s,t){"use strict";t.d(s,{AuthProvider:function(){return o},a:function(){return d}});var a=t(57437),r=t(2265),n=t(2141),i=t(69064),l=t(26098);let c=(0,r.createContext)(void 0);function o(e){let{children:s}=e,[t,o]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[m,x]=(0,r.useState)(null),[h,f]=(0,r.useState)(!0),g=async e=>{try{if(d&&d.id===e){(0,l.wH)("debug","\uD83D\uDD04 User profile already loaded, skipping...");return}(0,l.wH)("debug","\uD83D\uDD04 Loading user profile for:",e);let{data:a,error:r}=await n.supabase.from("users").select("\n          *,\n          company:companies(*)\n        ").eq("id",e).single();if(r){console.warn("⚠️ Could not load user profile:",r.message);let e=(await n.supabase.auth.getUser()).data.user;if(e){var s,t;u({id:e.id,email:e.email,first_name:null===(s=e.user_metadata)||void 0===s?void 0:s.first_name,last_name:null===(t=e.user_metadata)||void 0===t?void 0:t.last_name})}return}(0,l.wH)("debug","✅ User profile loaded successfully"),u(a),x(a.company||null)}catch(e){console.warn("⚠️ Error loading user profile:",e)}};(0,r.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:s}}=await n.supabase.auth.getSession();(null==s?void 0:s.user)&&e&&(o(s.user),await g(s.user.id))}catch(e){console.error("Error initializing auth:",e)}finally{e&&f(!1)}})();let{data:{subscription:s}}=n.supabase.auth.onAuthStateChange(async(e,s)=>{var t;(0,l.wH)("debug","\uD83D\uDD04 Auth state change:",e,null==s?void 0:null===(t=s.user)||void 0===t?void 0:t.id),"SIGNED_OUT"===e?(o(null),u(null),x(null),i.ZP.success("Sesi\xf3n cerrada")):"SIGNED_IN"===e&&(null==s?void 0:s.user)?(o(s.user),d&&d.id===s.user.id||await g(s.user.id)):"TOKEN_REFRESHED"===e&&(0,l.wH)("debug","\uD83D\uDD04 Token refreshed successfully")}),a=setInterval(async()=>{if(e&&t)try{let{data:{session:e},error:s}=await n.supabase.auth.getSession();(s||!e)&&((0,l.wH)("info","\uD83D\uDD04 Session expired, signing out..."),o(null),u(null),x(null),i.ZP.error("Sesi\xf3n expirada. Por favor, inicia sesi\xf3n nuevamente."))}catch(e){console.warn("⚠️ Error checking session:",e)}},l.ob.SESSION.CHECK_INTERVAL);return()=>{e=!1,s.unsubscribe(),clearInterval(a)}},[]);let p=async(e,s)=>{let{data:t,error:a}=await n.supabase.auth.signInWithPassword({email:e,password:s});if(a)throw a;return t},y=async(e,s,t)=>{let{data:a,error:r}=await n.supabase.auth.signUp({email:e,password:s,options:{data:t}});if(r)throw r;return a},j=async()=>{await n.supabase.auth.signOut()},b=async e=>{if(!t)throw Error("Usuario no autenticado");let{error:s}=await n.supabase.from("users").update(e).eq("id",t.id);if(s)throw s;await g(t.id)};return(0,a.jsx)(c.Provider,{value:{user:t,profile:d,company:m,loading:h,signIn:p,signUp:y,signOut:j,updateProfile:b},children:s})}function d(){let e=(0,r.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},26098:function(e,s,t){"use strict";t.d(s,{ob:function(){return a},wH:function(){return r}});let a={CACHE:{STALE_TIME:3e4,REFETCH_INTERVAL:3e5,REQUEST_TIMEOUT:1e4},SESSION:{CHECK_INTERVAL:6e4,WARNING_TIME:3e5},LOGGING:{ENABLED:!1,MIN_LEVEL:"error"},SUPABASE:{CONNECTION_POOL_SIZE:10,CONNECTION_TIMEOUT:5e3,AUTO_RETRY:!0,MAX_RETRIES:3,SINGLETON_MODE:!0,CHECK_INITIALIZATION:!0}},r=function(e){for(var s=arguments.length,t=Array(s>1?s-1:0),r=1;r<s;r++)t[r-1]=arguments[r];if(!a.LOGGING.ENABLED)return;let n=["debug","info","warn","error"];n.indexOf(e)>=n.indexOf(a.LOGGING.MIN_LEVEL)&&console[e](...t)}},2141:function(e,s,t){"use strict";t.r(s),t.d(s,{supabase:function(){return i},supabaseAdmin:function(){return l}});var a=t(63887);let r="https://pbdsuhmwxqiwbpgyrhqt.supabase.co";function n(e,s,t){return(0,a.eI)(e,s,{...t,auth:{...t.auth,storage:window.localStorage,storageKey:"supabase.auth.token",flowType:"pkce",debug:!1,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})}let{supabase:i,supabaseAdmin:l}=function(){if(!globalThis.__supabaseInitialized){if(globalThis.__supabase)try{var e,s;null===(e=(s=globalThis.__supabase).removeAllChannels)||void 0===e||e.call(s)}catch(e){}globalThis.__supabase=n(r,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiZHN1aG13eHFpd2JwZ3lyaHF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwODYyMzMsImV4cCI6MjA3NDY2MjIzM30.u5TqGGpULVAD062GT3zbfdC5RwOrj-jacJhWNSbfqus",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),globalThis.__supabaseAdmin=n(r,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiZHN1aG13eHFpd2JwZ3lyaHF0Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1OTA4NjIzMywiZXhwIjoyMDc0NjYyMjMzfQ.vZDNEvaGYn4-FAvyym69OQxFZkpc4m1ufcCn45Jn3jE",{auth:{persistSession:!1,autoRefreshToken:!1}}),globalThis.__supabaseInitialized=!0}return{supabase:globalThis.__supabase,supabaseAdmin:globalThis.__supabaseAdmin}}()},42208:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},44794:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},94630:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},99397:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},18930:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},function(e){e.O(0,[5558,8829,3926,2971,2117,1744],function(){return e(e.s=17464)}),_N_E=e.O()}]);